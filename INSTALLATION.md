# Telegram Stars Shop - Инструкция по запуску

## ?? Полный чеклист для запуска

### ШАГ 1??: Подготовка Telegram Бота

1. **Откройте** [@BotFather](https://t.me/botfather) в Telegram
2. **Введите** команду `/newbot`
3. **Следуйте инструкциям** и создайте нового бота
4. **Скопируйте** токен бота (выглядит как: `123456:ABC-DEF1234...`)
5. **Откройте** [@userinfobot](https://t.me/userinfobot) в Telegram
6. **Скопируйте** ваш User ID (будет число типа `123456789`)

?? **СОХРАНИТЕ ОБА ЗНАЧЕНИЯ!**

### ШАГ 2??: Подготовка файлов конфигурации

1. **Откройте** файл `config/banks.json` в любом текстовом редакторе
2. **Замените** значения на свои:
   - Номера ваших карт
   - Имя владельца
   - Комиссии (если есть)

3. **Откройте** файл `config/prices.json`
4. **Проверьте** курс обмена доллара к сумам
5. **Отредактируйте** цены если нужно

### ШАГ 3??: Создание файла .env

1. **Скопируйте** файл `.env.example` в `.env`:
   - Windows: скопируйте и переименуйте
   - Linux/Mac: `cp .env.example .env`

2. **Откройте** `.env` в текстовом редакторе

3. **Заполните** все значения:

```env
# 1. Вставьте токен бота
TELEGRAM_BOT_TOKEN=ВАШ_ТОКЕН_БОТА_ЗДЕСЬ

# 2. Вставьте ваш User ID
TELEGRAM_ADMIN_CHAT_ID=ВАШ_USER_ID_ЗДЕСЬ

# 3. Вставьте URL вашего сайта (позже, после деплоя)
TELEGRAM_WEBHOOK_URL=https://ваш-домен.netlify.app/.netlify/functions/telegram-webhook

# 4. Придумайте пароль для админа (используйте при входе)
ADMIN_PASSWORD=ПРИДУМАЙТЕ_СЛОЖНЫЙ_ПАРОЛЬ

# 5. URL вашего будущего сайта
SITE_URL=https://ваш-домен.uz
```

### ШАГ 4??: Локальное тестирование

```bash
# 1. Установите зависимости
npm install

# 2. Запустите сайт локально
npm run dev

# 3. Откройте в браузере
http://localhost:8888

# 4. Админ-панель
http://localhost:8888/admin.html
# Логин: admin
# Пароль: ПРИДУМАЙТЕ_СЛОЖНЫЙ_ПАРОЛЬ (из .env)
```

**Протестируйте:**
- ? Выбор пакетов работает
- ? Загрузка скриншота работает
- ? Форма отправляется
- ? Админ-панель открывается
- ? Уведомления приходят в Telegram

### ШАГ 5??: Деплой на Netlify

1. **Создайте GitHub репозиторий** (если его еще нет)
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/YOUR_USERNAME/telegram-stars-shop.git
   git push -u origin main
   ```

2. **Зарегистрируйтесь** на [netlify.com](https://www.netlify.com)

3. **Создайте новый сайт:**
   - Нажмите "Add new site"
   - Выберите "Import an existing project"
   - Подключите GitHub репозиторий

4. **Установите переменные окружения:**
   - В панели Netlify: Settings ? Build & Deploy ? Environment
   - Нажмите "Edit variables"
   - Добавьте все значения из `.env`:
     - TELEGRAM_BOT_TOKEN
     - TELEGRAM_ADMIN_CHAT_ID
     - ADMIN_PASSWORD
     - SITE_URL
   - Сохраните

5. **Получите URL сайта:**
   - После успешного деплоя Netlify даст вам URL (например: `https://telegram-stars-123.netlify.app`)
   - Или используйте собственный домен

6. **Обновите WEBHOOK URL:**
   - Отредактируйте переменную `TELEGRAM_WEBHOOK_URL` в Netlify:
     ```
     https://ВАШ-NETLIFY-URL.netlify.app/.netlify/functions/telegram-webhook
     ```

### ШАГ 6??: Финальная настройка Telegram Бота

1. **Установите webhook для бота:**

   Замените значения и откройте эту ссылку в браузере:
   ```
   https://api.telegram.org/botВАШ_ТОКЕН_БОТА/setWebhook?url=https://ВАШ-NETLIFY-URL.netlify.app/.netlify/functions/telegram-webhook
   ```

   Результат должен быть:
   ```json
   {"ok":true,"result":true,"description":"Webhook was set"}
   ```

2. **Протестируйте бота:**
   - Напишите боту `/start`
   - Бот должен ответить
   - Напишите `/orders` для проверки

### ? Проверка Готовности

Убедитесь, что все работает:

- [ ] Сайт открывается по вашему URL
- [ ] Пакеты Stars отображаются с ценами
- [ ] Можно выбрать пакет и оформить заказ
- [ ] Скриншот загружается корректно
- [ ] Админ получает уведомление в Telegram
- [ ] Админ-панель защищена паролем
- [ ] Админ может подтвердить/отклонить заказ
- [ ] Пользователь получает уведомление об обработке

## ?? Первый реальный заказ

1. **Откройте сайт** и выберите пакет Stars
2. **Введите свой Telegram username**
3. **Загрузите скриншот оплаты** (может быть тестовый)
4. **Отправьте заказ**
5. **Проверьте Telegram** - должно быть уведомление
6. **Откройте админ-панель** и подтвердите заказ
7. **Получите уведомление** об успешной обработке

## ?? Полезные команды

```bash
# Локальное тестирование
npm run dev

# Деплой на Netlify
npm run deploy

# Просмотр логов Netlify
netlify logs

# Синхронизация с GitHub (автоматический деплой)
git push

# Проверка статуса бота
curl "https://api.telegram.org/botВАШ_ТОКЕН/getMe"
```

## ?? Решение проблем

### Проблема: "Webhook was not set"

**Решение:**
1. Проверьте правильность URL вашего Netlify сайта
2. Убедитесь, что функции развернулись (Build succeed)
3. Попробуйте еще раз через 5 минут

### Проблема: Уведомления не приходят

**Решение:**
1. Проверьте токен бота
2. Проверьте Chat ID (это должно быть число)
3. Убедитесь, что боту написано хоть одно сообщение
4. Проверьте логи в панели Netlify

### Проблема: Админ-панель не открывается

**Решение:**
1. Проверьте, что пароль правильный
2. Очистите cookies браузера
3. Попробуйте инкогнито-режим

### Проблема: Stars не отправляются

**Решение:**
1. Если используется Fragment API - проверьте ключ
2. Если ручная отправка - отправьте Stars вручную через Fragment.com
3. Пользователь получит уведомление в любом случае

## ?? Контакты для помощи

- **Telegram**: @BotFather (для помощи с ботом)
- **Netlify**: support@netlify.com (для проблем с хостингом)
- **Fragment**: support@fragment.com (для помощи со Stars API)

---

**Все готово! Ваш сайт для продажи Telegram Stars запущен и работает! ??**
